VERSION_MAJOR		= 0
VERSION_MINOR		= 1
VERSION_REVISION	= 0

DEFINES	+= VERSION_MAJOR=$(VERSION_MAJOR)
DEFINES	+= VERSION_MINOR=$(VERSION_MINOR)
DEFINES	+= VERSION_REVISION=$(VERSION_REVISION)

DISTNAME = PalmAlbum_$(VERSION_MAJOR).$(VERSION_MINOR).$(VERSION_REVISION)
# CPU should be set using uname
CPU = x86
BINARC = $(DISTNAME)_$(CPU).zip
SRCARC = $(DISTNAME)_src.zip

bin/PalmAlbumTranslator -> executable:
	[
		PalmAlbumTranslator.cpp^object:static
		PalmAlbumRead.cpp^object:static
		PalmAlbumWrite.cpp^object:static
		
		../../common/dle/lib/liblayoutengine.a
		../../common/gfx/lib/libgfx.a
		../../common/misc/lib/libmisc.a
		
		PalmAlbumTranslatorX86.rsrc
	]
	(
	)
{
	LDFLAGS += -lbe -lpisock
}


install ::
	(
		bin/PalmAlbumTranslator^executable:
	)
{
	<<<
 		$(_builddir_)/bin/PalmAlbumTranslator --install
	>>>
}

binarc ::
	(
		bin/PalmAlbumTranslator^executable:
		translators/palmalbum/documentation/gendoc
	)
{
	<<<
		sh -c "\
			mkdir -p $(DISTNAME) ; \
	 		copyattr -d $(_builddir_)/bin/PalmAlbumTranslator $(DISTNAME) && \
	 		copyattr -d $(_builddir_)/documentation/* $(DISTNAME) && \
			copyattr -d '$(_sourcedir_)/RegisterMime.sh' $(DISTNAME) && \
			chmod +x $(DISTNAME)/*.sh && \
	 		mimeset -F $(DISTNAME) && \
	 		rm $(BINARC) >/dev/null 2>&1 ; \
	 		zip -9r $(BINARC) $(DISTNAME) && \
	 		rm $(DISTNAME)/* && \
	 		rmdir $(DISTNAME)"
	>>>
}

